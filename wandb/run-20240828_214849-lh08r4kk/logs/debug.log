2024-08-28 21:48:49,777 INFO    MainThread:1965581 [wandb_setup.py:_flush():76] Current SDK version is 0.17.6
2024-08-28 21:48:49,777 INFO    MainThread:1965581 [wandb_setup.py:_flush():76] Configure stats pid to 1965581
2024-08-28 21:48:49,777 INFO    MainThread:1965581 [wandb_setup.py:_flush():76] Loading settings from /local/scratch/a/ko120/.config/wandb/settings
2024-08-28 21:48:49,777 INFO    MainThread:1965581 [wandb_setup.py:_flush():76] Loading settings from /local/scratch/a/ko120/DM-Benchmark/wandb/settings
2024-08-28 21:48:49,777 INFO    MainThread:1965581 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-08-28 21:48:49,777 INFO    MainThread:1965581 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-08-28 21:48:49,777 INFO    MainThread:1965581 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'train.py', 'program_abspath': '/local/scratch/a/ko120/DM-Benchmark/train.py', 'program': '/local/scratch/a/ko120/DM-Benchmark/train.py'}
2024-08-28 21:48:49,777 INFO    MainThread:1965581 [wandb_setup.py:_flush():76] Applying login settings: {}
2024-08-28 21:48:49,777 INFO    MainThread:1965581 [wandb_init.py:_log_setup():521] Logging user logs to ./wandb/run-20240828_214849-lh08r4kk/logs/debug.log
2024-08-28 21:48:49,777 INFO    MainThread:1965581 [wandb_init.py:_log_setup():522] Logging internal logs to ./wandb/run-20240828_214849-lh08r4kk/logs/debug-internal.log
2024-08-28 21:48:49,777 INFO    MainThread:1965581 [wandb_init.py:init():559] calling init triggers
2024-08-28 21:48:49,778 INFO    MainThread:1965581 [wandb_init.py:init():566] wandb.init called with sweep_config: {}
config: {}
2024-08-28 21:48:49,778 INFO    MainThread:1965581 [wandb_init.py:init():609] starting backend
2024-08-28 21:48:49,778 INFO    MainThread:1965581 [wandb_init.py:init():613] setting up manager
2024-08-28 21:48:49,780 INFO    MainThread:1965581 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-08-28 21:48:49,781 INFO    MainThread:1965581 [wandb_init.py:init():621] backend started and connected
2024-08-28 21:48:49,784 INFO    MainThread:1965581 [wandb_init.py:init():716] updated telemetry
2024-08-28 21:48:49,792 INFO    MainThread:1965581 [wandb_init.py:init():749] communicating run to backend with 90.0 second timeout
2024-08-28 21:48:50,067 INFO    MainThread:1965581 [wandb_run.py:_on_init():2438] communicating current version
2024-08-28 21:48:50,124 INFO    MainThread:1965581 [wandb_run.py:_on_init():2447] got version response upgrade_message: "wandb version 0.17.8 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-08-28 21:48:50,125 INFO    MainThread:1965581 [wandb_init.py:init():800] starting run threads in backend
2024-08-28 21:48:51,896 INFO    MainThread:1965581 [wandb_run.py:_console_start():2416] atexit reg
2024-08-28 21:48:51,897 INFO    MainThread:1965581 [wandb_run.py:_redirect():2258] redirect: wrap_raw
2024-08-28 21:48:51,897 INFO    MainThread:1965581 [wandb_run.py:_redirect():2323] Wrapping output streams.
2024-08-28 21:48:51,897 INFO    MainThread:1965581 [wandb_run.py:_redirect():2348] Redirects installed.
2024-08-28 21:48:51,900 INFO    MainThread:1965581 [wandb_init.py:init():843] run started, returning control to user process
2024-08-28 21:48:51,901 INFO    MainThread:1965581 [wandb_run.py:_config_callback():1385] config_cb None None {'model': "{'_target_': 'src.models.fair_lightening_module.fair_ClassificationLitModule', 'net': {'_target_': 'src.models.components.models.LaftrNet', 'input_size': 102, 'output_size': 2, 'zdim': 16, 'edepth': 2, 'ewidths': 32, 'cdepth': 2, 'cwidths': 32, 'adepth': 2, 'awidths': 32, 'num_groups': 2}, 'lr': 0.001, 'weight_decay': 0.0005, 'criterion': {'_target_': 'src.metrics.train_metrics.ClassificationMixedLoss', 'loss_scalers': {'nll': 1, 'mmd': 0.2}, 'operands': {'x': 'rbf', 'y': 'rbf'}, 'scalers': {'x': 1.0, 'y': 1.0}, 'bandwidths': {'x': 10.0, 'y': 0.01}}, 'kcal_kwargs': {'operands': {'x': 'rbf', 'y': 'rbf'}, 'scalers': {'x': 1.0, 'y': 1.0}, 'bandwidths': {'x': 10.0, 'y': 0.01}}}", 'model/params/total': 8179, 'model/params/trainable': 8179, 'model/params/non_trainable': 0, 'datamodule': "{'_target_': 'src.datamodules.classification_datamodule.ClassificationDataModule', 'dataset_name': 'adult_fair', 'data_dir': '${paths.data_dir}', 'batch_size': 64, 'test_batch_size': 8, 'train_val_test_split': [0.7, 0.1, 0.2], 'num_workers': 0, 'pin_memory': False}", 'trainer': "{'_target_': 'pytorch_lightning.Trainer', 'accelerator': 'gpu', 'devices': 1, 'min_epochs': 10, 'max_epochs': 1}", 'seed': 12345, 'callbacks': "{'model_checkpoint': {'_target_': 'pytorch_lightning.callbacks.ModelCheckpoint', 'monitor': 'val/loss', 'mode': 'min', 'save_top_k': 1, 'save_last': True, 'verbose': False, 'dirpath': 'checkpoints/', 'filename': 'epoch_{epoch:03d}', 'auto_insert_metric_name': False}, 'early_stopping': {'_target_': 'pytorch_lightning.callbacks.EarlyStopping', 'monitor': 'val/loss', 'mode': 'min', 'patience': 30, 'min_delta': 0}, 'model_summary': {'_target_': 'pytorch_lightning.callbacks.RichModelSummary', 'max_depth': -1}, 'rich_progress_bar': {'_target_': 'pytorch_lightning.callbacks.RichProgressBar'}}"}
2024-08-28 21:49:19,667 WARNING MsgRouterThr:1965581 [router.py:message_loop():77] message_loop has been closed
