[[36m2024-08-28 15:30:09,159[39m][[34msrc.training_pipeline[39m][[32mINFO[39m] - Starting training!
[[36m2024-08-28 15:30:09,199[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - You are using a CUDA device ('NVIDIA RTX A5000') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[[36m2024-08-28 15:30:09,201[39m][[34mpytorch_lightning.accelerators.cuda[39m][[32mINFO[39m] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
┏━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃[1m    [22m┃[1m Name                    [22m┃[1m Type                                 [22m┃[1m Params [22m┃[1m Mode  [22m┃
┡━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ 0  │ net                     │ MLP                                  │ 93.2 K │ train │
│ 1  │ net.hiddens             │ ModuleList                           │ 93.2 K │ train │
│ 2  │ net.hiddens.0           │ Linear                               │ 26.9 K │ train │
│ 3  │ net.hiddens.1           │ Linear                               │ 65.8 K │ train │
│ 4  │ net.hiddens.2           │ Linear                               │    514 │ train │
│ 5  │ train_acc               │ BinaryAccuracy                       │      0 │ train │
│ 6  │ val_acc                 │ BinaryAccuracy                       │      0 │ train │
│ 7  │ test_acc                │ BinaryAccuracy                       │      0 │ train │
│ 8  │ train_ece               │ MulticlassCalibrationError           │      0 │ train │
│ 9  │ val_ece                 │ MulticlassCalibrationError           │      0 │ train │
│ 10 │ test_ece                │ MulticlassCalibrationError           │      0 │ train │
│ 11 │ train_entropy           │ ShannonEntropyError                  │      0 │ train │
│ 12 │ val_entropy             │ ShannonEntropyError                  │      0 │ train │
│ 13 │ test_entropy            │ ShannonEntropyError                  │      0 │ train │
│ 14 │ test_kcal               │ ClassificationKernelCalibrationError │      0 │ train │
│ 15 │ val_acc_best            │ MaxMetric                            │      0 │ train │
│ 16 │ val_ece_best            │ MinMetric                            │      0 │ train │
│ 17 │ val_entropy_best        │ MinMetric                            │      0 │ train │
│ 18 │ test_calibrated_acc     │ BinaryAccuracy                       │      0 │ train │
│ 19 │ test_calibrated_ece     │ MulticlassCalibrationError           │      0 │ train │
│ 20 │ test_calibrated_entropy │ ShannonEntropyError                  │      0 │ train │
│ 21 │ test_calibrated_kcal    │ ClassificationKernelCalibrationError │      0 │ train │
└────┴─────────────────────────┴──────────────────────────────────────┴────────┴───────┘
[1mTrainable params[22m: 93.2 K
[1mNon-trainable params[22m: 0
[1mTotal params[22m: 93.2 K
[1mTotal estimated model params size (MB)[22m: 0
[1mModules in train mode[22m: 22
[1mModules in eval mode[22m: 0
/local/scratch/a/ko120/miniconda3/envs/dm_real/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:424: The 'val_dataloader' does not have many workers which may
be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=23` in the `DataLoader` to improve performance.
/local/scratch/a/ko120/miniconda3/envs/dm_real/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:424: The 'train_dataloader' does not have many workers which
may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=23` in the `DataLoader` to improve performance.
[37mEpoch 0/29[39m [38m━━━━━━━━━━━━╺━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m99/329[39m [38m0:00:01 • 0:00:03[39m [38m89.61it/s[39m [37mv_num: 08ab

[37mEpoch 0/29[39m [38m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m329/329[39m [38m0:00:03 • 0:00:00[39m [38m89.84it/s [39m [37mv_num: 08ab
                                                                                        [37mval/ece_best: 0.018 val/entropy_best: 0.335 train/loss: 0.365 train/acc: 0.832 train/ece: 0.020          
                                                                                         [37mtrain/entropy: 0.352                                                                                    

                                                                                         [37mtrain/entropy: 0.315                                                                                    



                                                                                       [37mval/ece_best: 0.017 val/entropy_best: 0.290 train/loss: 0.306 train/acc: 0.857 train/ece: 0.005           

                                                                                         [37mtrain/entropy: 0.305                                                                                    

                                                                                         [37mtrain/entropy: 0.300                                                                                    



Epoch 6/29 [38m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m329/329[39m [38m0:00:03 • 0:00:00[39m [38m82.37it/s[39m [37mv_num: 08ab val/loss: 0.336 val/acc: 0.840 val/ece: 0.036 val/entropy: 0.282 val/acc_best: 0.843         
                                                                                        [37mval/ece_best: 0.017 val/entropy_best: 0.280 train/loss: 0.298 train/acc: 0.862 train/ece: 0.003          
                                                                                        [37mtrain/entropy: 0.297                                                                                     






Epoch 8/29 [38m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m329/329[39m [38m0:00:03 • 0:00:00[39m [38m85.45it/s [39m [37mv_num: 08ab val/loss: 0.337 val/acc: 0.839 val/ece: 0.032 val/entropy: 0.284 val/acc_best: 0.843        
                                                                                        [37mval/ece_best: 0.017 val/entropy_best: 0.280 train/loss: 0.290 train/acc: 0.866 train/ece: 0.004          

                                                                                         [37mval/ece_best: 0.016 val/entropy_best: 0.280 train/loss: 0.287 train/acc: 0.868 train/ece: 0.003         

Epoch 11/29 [38m━━━━━━━━━━╸━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m87/329[39m [38m0:00:01 • 0:00:03[39m [38m86.05it/s[39m [37mv_num: 08ab val/loss: 0.335 val/acc: 0.838 val/ece: 0.024 val/entropy: 0.306 val/acc_best: 0.845         
                                                                                        [37mval/ece_best: 0.016 val/entropy_best: 0.280 train/loss: 0.285 train/acc: 0.870 train/ece: 0.003          

                                                                                          [37mtrain/entropy: 0.284                                                                                   



Epoch 13/29 [38m━━━━━━━━╸━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m73/329[39m [38m0:00:00 • 0:00:03[39m [38m90.87it/s[39m [37mv_num: 08ab val/loss: 0.340 val/acc: 0.839 val/ece: 0.029 val/entropy: 0.292 val/acc_best: 0.845         
                                                                                        [37mval/ece_best: 0.016 val/entropy_best: 0.278 train/loss: 0.281 train/acc: 0.873 train/ece: 0.005          

                                                                                          [37mtrain/entropy: 0.278                                                                                   




Epoch 15/29 [38m━━━━━━━━━━━━━━━━━━╸━━━━━━━━━━━━━━━━━━━━━[39m [37m155/329[39m [38m0:00:01 • 0:00:02[39m [38m87.66it/s[39m [37mv_num: 08ab val/loss: 0.342 val/acc: 0.843 val/ece: 0.031 val/entropy: 0.280 val/acc_best: 0.845        
                                                                                         [37mval/ece_best: 0.016 val/entropy_best: 0.274 train/loss: 0.278 train/acc: 0.873 train/ece: 0.003         
                                                                                          [37mtrain/entropy: 0.275                                                                                   

                                                                                          [37mtrain/entropy: 0.271                                                                                   

Epoch 17/29 [38m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╺━━━━━━[39m [37m275/329[39m [38m0:00:03 • 0:00:01[39m [38m87.06it/s[39m [37mv_num: 08ab val/loss: 0.337 val/acc: 0.845 val/ece: 0.025 val/entropy: 0.283 val/acc_best: 0.845        
                                                                                         [37mval/ece_best: 0.016 val/entropy_best: 0.274 train/loss: 0.276 train/acc: 0.873 train/ece: 0.006         
                                                                                          [37mtrain/entropy: 0.274                                                                                   

Epoch 18/29 [38m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸━━━━━━━━[39m [37m260/329[39m [38m0:00:03 • 0:00:01[39m [38m84.11it/s[39m [37mv_num: 08ab val/loss: 0.337 val/acc: 0.842 val/ece: 0.033 val/entropy: 0.280 val/acc_best: 0.845        
                                                                                          [37mval/ece_best: 0.016 val/entropy_best: 0.274 train/loss: 0.276 train/acc: 0.873 train/ece: 0.004        
                                                                                          [37mtrain/entropy: 0.272                                                                                   



Epoch 20/29 [38m━━━━━━━━━━━━╸━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m106/329[39m [38m0:00:01 • 0:00:03[39m [38m87.93it/s[39m [37mv_num: 08ab val/loss: 0.343 val/acc: 0.841 val/ece: 0.034 val/entropy: 0.277 val/acc_best: 0.845        
                                                                                         [37mval/ece_best: 0.016 val/entropy_best: 0.267 train/loss: 0.270 train/acc: 0.878 train/ece: 0.005         
                                                                                          [37mtrain/entropy: 0.268                                                                                   



Epoch 22/29 [38m━━━━━━━━━╸━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m80/329[39m [38m0:00:00 • 0:00:03[39m [38m88.03it/s[39m [37mv_num: 08ab val/loss: 0.361 val/acc: 0.843 val/ece: 0.048 val/entropy: 0.244 val/acc_best: 0.845         
                                                                                        [37mval/ece_best: 0.016 val/entropy_best: 0.244 train/loss: 0.268 train/acc: 0.877 train/ece: 0.004          

                                                                                          [37mtrain/entropy: 0.269                                                                                   



Epoch 24/29 [38m━━━╸━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m32/329[39m [38m0:00:00 • 0:00:04[39m [38m82.18it/s[39m [37mv_num: 08ab val/loss: 0.359 val/acc: 0.841 val/ece: 0.032 val/entropy: 0.280 val/acc_best: 0.845         
                                                                                        [37mval/ece_best: 0.016 val/entropy_best: 0.244 train/loss: 0.264 train/acc: 0.880 train/ece: 0.004          


Epoch 25/29 [38m━━╸━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m22/329[39m [38m0:00:00 • 0:00:04[39m [38m83.66it/s[39m [37mv_num: 08ab val/loss: 0.361 val/acc: 0.840 val/ece: 0.041 val/entropy: 0.263 val/acc_best: 0.845         
                                                                                        [37mval/ece_best: 0.016 val/entropy_best: 0.244 train/loss: 0.264 train/acc: 0.881 train/ece: 0.004          


Epoch 26/29 [38m━━╺━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m20/329[39m [38m0:00:00 • 0:00:04[39m [38m92.63it/s[39m [37mv_num: 08ab val/loss: 0.357 val/acc: 0.841 val/ece: 0.040 val/entropy: 0.263 val/acc_best: 0.845         


Epoch 27/29 [38m━━━━━━━━━━━━━━━━╺━━━━━━━━━━━━━━━━━━━━━━━[39m [37m135/329[39m [38m0:00:01 • 0:00:03[39m [38m86.69it/s[39m [37mv_num: 08ab val/loss: 0.356 val/acc: 0.839 val/ece: 0.050 val/entropy: 0.250 val/acc_best: 0.845        
                                                                                         [37mval/ece_best: 0.016 val/entropy_best: 0.244 train/loss: 0.262 train/acc: 0.880 train/ece: 0.004         

Epoch 28/29 [38m━━━━━━━━━━━━━━╸━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m123/329[39m [38m0:00:01 • 0:00:03[39m [38m85.00it/s[39m [37mv_num: 08ab val/loss: 0.370 val/acc: 0.835 val/ece: 0.053 val/entropy: 0.252 val/acc_best: 0.845        
                                                                                         [37mval/ece_best: 0.016 val/entropy_best: 0.244 train/loss: 0.263 train/acc: 0.881 train/ece: 0.004         
                                                                                          [37mtrain/entropy: 0.260                                                                                   


                                                                                          [37mtrain/entropy: 0.261                                                                                   
[37mValidation[39m  [38m━━━━━━━━━━━━━━━━━━━━╺━━━━━━━━━━━━━━━━━━━
                                                                                         [37mtrain/entropy: 0.261                                                                                    
[?25h[[36m2024-08-28 15:33:20,869[39m][[34msrc.training_pipeline[39m][[32mINFO[39m] - Starting testing!
[[36m2024-08-28 15:33:20,870[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - Restoring states from the checkpoint path at /local/scratch/a/ko120/DM-Benchmark/checkpoints/epoch_008.ckpt
[[36m2024-08-28 15:33:20,874[39m][[34mpytorch_lightning.accelerators.cuda[39m][[32mINFO[39m] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[[36m2024-08-28 15:33:20,937[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - Loaded model weights from the checkpoint at /local/scratch/a/ko120/DM-Benchmark/checkpoints/epoch_008.ckpt

┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃[1m        Test metric        [22m┃[1m       DataLoader 0        [22m┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│[36m         test/acc          [39m│[35m    0.8502984046936035     [39m│
│[36m    test/calibrated_acc    [39m│[35m    0.8502984046936035     [39m│
│[36m    test/calibrated_ece    [39m│[35m   0.011653443798422813    [39m│
│[36m  test/calibrated_entropy  [39m│[35m    0.33279648423194885    [39m│
│[36m   test/calibrated_kcal    [39m│[35m  0.00023120595142245293   [39m│
│[36m         test/ece          [39m│[35m   0.011653464287519455    [39m│
│[36m       test/entropy        [39m│[35m    0.33279648423194885    [39m│
│[36m         test/kcal         [39m│[35m  1.1530937626957893e-05   [39m│
│[36m         test/loss         [39m│[35m    0.33274489641189575    [39m│
└───────────────────────────┴───────────────────────────┘
[37mTesting[39m [38m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m754/754[39m [38m0:00:03 • 0:00:00[39m [38m208.61it/s
[?25h[[36m2024-08-28 15:33:25,397[39m][[34msrc.training_pipeline[39m][[32mINFO[39m] - Finalizing!