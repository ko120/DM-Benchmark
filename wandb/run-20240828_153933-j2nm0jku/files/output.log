[[36m2024-08-28 15:39:35,589[39m][[34msrc.training_pipeline[39m][[32mINFO[39m] - Starting training!
[[36m2024-08-28 15:39:35,620[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - You are using a CUDA device ('NVIDIA RTX A5000') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
[[36m2024-08-28 15:39:35,622[39m][[34mpytorch_lightning.accelerators.cuda[39m][[32mINFO[39m] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”“
â”ƒ[1m    [22mâ”ƒ[1m Name                    [22mâ”ƒ[1m Type                                 [22mâ”ƒ[1m Params [22mâ”ƒ[1m Mode  [22mâ”ƒ
â”¡â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”©
â”‚ 0  â”‚ net                     â”‚ MLP                                  â”‚ 93.2 K â”‚ train â”‚
â”‚ 1  â”‚ net.hiddens             â”‚ ModuleList                           â”‚ 93.2 K â”‚ train â”‚
â”‚ 2  â”‚ net.hiddens.0           â”‚ Linear                               â”‚ 26.9 K â”‚ train â”‚
â”‚ 3  â”‚ net.hiddens.1           â”‚ Linear                               â”‚ 65.8 K â”‚ train â”‚
â”‚ 4  â”‚ net.hiddens.2           â”‚ Linear                               â”‚    514 â”‚ train â”‚
â”‚ 5  â”‚ train_acc               â”‚ BinaryAccuracy                       â”‚      0 â”‚ train â”‚
â”‚ 6  â”‚ val_acc                 â”‚ BinaryAccuracy                       â”‚      0 â”‚ train â”‚
â”‚ 7  â”‚ test_acc                â”‚ BinaryAccuracy                       â”‚      0 â”‚ train â”‚
â”‚ 8  â”‚ train_ece               â”‚ MulticlassCalibrationError           â”‚      0 â”‚ train â”‚
â”‚ 9  â”‚ val_ece                 â”‚ MulticlassCalibrationError           â”‚      0 â”‚ train â”‚
â”‚ 10 â”‚ test_ece                â”‚ MulticlassCalibrationError           â”‚      0 â”‚ train â”‚
â”‚ 11 â”‚ train_entropy           â”‚ ShannonEntropyError                  â”‚      0 â”‚ train â”‚
â”‚ 12 â”‚ val_entropy             â”‚ ShannonEntropyError                  â”‚      0 â”‚ train â”‚
â”‚ 13 â”‚ test_entropy            â”‚ ShannonEntropyError                  â”‚      0 â”‚ train â”‚
â”‚ 14 â”‚ test_kcal               â”‚ ClassificationKernelCalibrationError â”‚      0 â”‚ train â”‚
â”‚ 15 â”‚ val_acc_best            â”‚ MaxMetric                            â”‚      0 â”‚ train â”‚
â”‚ 16 â”‚ val_ece_best            â”‚ MinMetric                            â”‚      0 â”‚ train â”‚
â”‚ 17 â”‚ val_entropy_best        â”‚ MinMetric                            â”‚      0 â”‚ train â”‚
â”‚ 18 â”‚ test_calibrated_acc     â”‚ BinaryAccuracy                       â”‚      0 â”‚ train â”‚
â”‚ 19 â”‚ test_calibrated_ece     â”‚ MulticlassCalibrationError           â”‚      0 â”‚ train â”‚
â”‚ 20 â”‚ test_calibrated_entropy â”‚ ShannonEntropyError                  â”‚      0 â”‚ train â”‚
â”‚ 21 â”‚ test_calibrated_kcal    â”‚ ClassificationKernelCalibrationError â”‚      0 â”‚ train â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
[1mTrainable params[22m: 93.2 K
[1mNon-trainable params[22m: 0
[1mTotal params[22m: 93.2 K
[1mTotal estimated model params size (MB)[22m: 0
[1mModules in train mode[22m: 22
[1mModules in eval mode[22m: 0
/local/scratch/a/ko120/miniconda3/envs/dm_real/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:424: The 'val_dataloader' does not have many workers which may
be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=23` in the `DataLoader` to improve performance.
/local/scratch/a/ko120/miniconda3/envs/dm_real/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:424: The 'train_dataloader' does not have many workers which
may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=23` in the `DataLoader` to improve performance.
[37mEpoch 0/29[39m [38mâ”â”â”â”â”â”â”â”â”â”â”â•¸â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[39m [37m98/329[39m [38m0:00:01 â€¢ 0:00:03[39m [38m82.88it/s[39m [37mv_num: 0jku

[37mEpoch 0/29[39m [38mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[39m [37m329/329[39m [38m0:00:03 â€¢ 0:00:00[39m [38m87.70it/s [39m [37mv_num: 0jku
                                                                                       [37mval/ece_best: 0.018 val/entropy_best: 0.335 train/loss: 0.365 train/acc: 0.832 train/ece: 0.020           

Epoch 1/29 [38mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[39m [37m329/329[39m [38m0:00:04 â€¢ 0:00:00[39m [38m80.43it/s [39m [37mv_num: 0jku val/loss: 0.338 val/acc: 0.837 val/ece: 0.018 val/entropy: 0.335 val/acc_best: 0.837        
                                                                                         [37mval/ece_best: 0.018 val/entropy_best: 0.335 train/loss: 0.365 train/acc: 0.832 train/ece: 0.020         
                                                                                         [37mtrain/entropy: 0.352                                                                                    


[37mValidation[39m [38mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¸â”â”[39m [37m355/377[39m [38m0:00:02 â€¢ 0:00:01[39m [38m126.28it/s




Epoch 4/29 [38mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¸â”â”â”â”â”â”â”â”â”â”[39m [37m244/329[39m [38m0:00:02 â€¢ 0:00:01[39m [38m86.22it/s[39m [37mv_num: 0jku val/loss: 0.332 val/acc: 0.838 val/ece: 0.017 val/entropy: 0.319 val/acc_best: 0.843         
                                                                                        [37mval/ece_best: 0.017 val/entropy_best: 0.290 train/loss: 0.306 train/acc: 0.857 train/ece: 0.005          
                                                                                         [37mtrain/entropy: 0.305                                                                                    

Epoch 5/29 [38mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•ºâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[39m [37m124/329[39m [38m0:00:01 â€¢ 0:00:03[39m [38m86.07it/s[39m [37mv_num: 0jku val/loss: 0.333 val/acc: 0.843 val/ece: 0.030 val/entropy: 0.280 val/acc_best: 0.843         
                                                                                        [37mval/ece_best: 0.017 val/entropy_best: 0.280 train/loss: 0.300 train/acc: 0.861 train/ece: 0.006          
                                                                                         [37mtrain/entropy: 0.300                                                                                    

Epoch 6/29 [38mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•ºâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[39m [37m206/329[39m [38m0:00:02 â€¢ 0:00:02[39m [38m86.98it/s[39m [37mv_num: 0jku val/loss: 0.336 val/acc: 0.840 val/ece: 0.036 val/entropy: 0.282 val/acc_best: 0.843         
                                                                                         [37mval/ece_best: 0.017 val/entropy_best: 0.280 train/loss: 0.298 train/acc: 0.862 train/ece: 0.003         
                                                                                         [37mtrain/entropy: 0.297                                                                                    



Epoch 8/29 [38mâ”â”â”â”â•ºâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[39m [37m36/329[39m [38m0:00:00 â€¢ 0:00:04[39m [38m93.35it/s[39m [37mv_num: 0jku val/loss: 0.337 val/acc: 0.839 val/ece: 0.032 val/entropy: 0.284 val/acc_best: 0.843          
                                                                                       [37mval/ece_best: 0.017 val/entropy_best: 0.280 train/loss: 0.291 train/acc: 0.865 train/ece: 0.006           

                                                                                         [37mtrain/entropy: 0.292                                                                                    

Epoch 9/29 [38mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•ºâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[39m [37m126/329[39m [38m0:00:01 â€¢ 0:00:03[39m [38m87.41it/s[39m [37mv_num: 0jku val/loss: 0.329 val/acc: 0.845 val/ece: 0.020 val/entropy: 0.327 val/acc_best: 0.845         
                                                                                        [37mval/ece_best: 0.017 val/entropy_best: 0.280 train/loss: 0.290 train/acc: 0.866 train/ece: 0.004          
                                                                                         [37mtrain/entropy: 0.288                                                                                    



Epoch 10/29 [38mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[39m [37m329/329[39m [38m0:00:03 â€¢ 0:00:00[39m [38m87.89it/s [39m [37mv_num: 0jku val/loss: 0.331 val/acc: 0.841 val/ece: 0.016 val/entropy: 0.306 val/acc_best: 0.845       
                                                                                          [37mval/ece_best: 0.016 val/entropy_best: 0.280 train/loss: 0.287 train/acc: 0.868 train/ece: 0.003        
                                                                                          [37mtrain/entropy: 0.286                                                                                   


                                                                                          [37mtrain/entropy: 0.284                                                                                   


                                                                                          [37mtrain/entropy: 0.283                                                                                   


Epoch 13/29 [38mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[39m [37m329/329[39m [38m0:00:03 â€¢ 0:00:00[39m [38m85.01it/s [39m [37mv_num: 0jku val/loss: 0.340 val/acc: 0.839 val/ece: 0.029 val/entropy: 0.292 val/acc_best: 0.845       
                                                                                          [37mval/ece_best: 0.016 val/entropy_best: 0.278 train/loss: 0.281 train/acc: 0.873 train/ece: 0.005        
                                                                                          [37mtrain/entropy: 0.278                                                                                   

Epoch 14/29 [38mâ”â”â”â”â”â”â”â”â”â”â”â•ºâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[39m [37m91/329[39m [38m0:00:01 â€¢ 0:00:03[39m [38m87.06it/s[39m [37mv_num: 0jku val/loss: 0.350 val/acc: 0.836 val/ece: 0.040 val/entropy: 0.274 val/acc_best: 0.845         
                                                                                        [37mval/ece_best: 0.016 val/entropy_best: 0.274 train/loss: 0.279 train/acc: 0.872 train/ece: 0.004          

                                                                                          [37mtrain/entropy: 0.278                                                                                   


Epoch 15/29 [38mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[39m [37m329/329[39m [38m0:00:03 â€¢ 0:00:00[39m [38m89.44it/s [39m [37mv_num: 0jku val/loss: 0.342 val/acc: 0.843 val/ece: 0.031 val/entropy: 0.280 val/acc_best: 0.845       
                                                                                          [37mval/ece_best: 0.016 val/entropy_best: 0.274 train/loss: 0.278 train/acc: 0.873 train/ece: 0.003        
                                                                                          [37mtrain/entropy: 0.275                                                                                   




                                                                                         [37mval/ece_best: 0.016 val/entropy_best: 0.274 train/loss: 0.276 train/acc: 0.873 train/ece: 0.005         
                                                                                          [37mval/ece_best: 0.016 val/entropy_best: 0.274 train/loss: 0.276 train/acc: 0.873 train/ece: 0.005        
                                                                                          [37mtrain/entropy: 0.271                                                                                   

                                                                                          [37mtrain/entropy: 0.274                                                                                   


                                                                                          [37mtrain/entropy: 0.272                                                                                   


                                                                                          [37mtrain/entropy: 0.270                                                                                   


Epoch 20/29 [38mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•ºâ”â”â”â”â”â”[39m [37m273/329[39m [38m0:00:03 â€¢ 0:00:01[39m [38m88.95it/s[39m [37mv_num: 0jku val/loss: 0.343 val/acc: 0.841 val/ece: 0.034 val/entropy: 0.277 val/acc_best: 0.845        
                                                                                         [37mval/ece_best: 0.016 val/entropy_best: 0.267 train/loss: 0.270 train/acc: 0.878 train/ece: 0.005         

                                                                                         [37mtrain/entropy: 0.268                                                                                    
Epoch 20/29 [38mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[39m [37m329/329[39m [38m0:00:03 â€¢ 0:00:00[39m [38m88.86it/s [39m [37mv_num: 0jku val/loss: 0.343 val/acc: 0.841 val/ece: 0.034 val/entropy: 0.277 val/acc_best: 0.845       
                                                                                          [37mval/ece_best: 0.016 val/entropy_best: 0.267 train/loss: 0.270 train/acc: 0.878 train/ece: 0.005        
                                                                                          [37mtrain/entropy: 0.268                                                                                   

                                                                                          [37mtrain/entropy: 0.269                                                                                   



                                                                                          [37mtrain/entropy: 0.269                                                                                   


                                                                                          [37mtrain/entropy: 0.264                                                                                   



Epoch 25/29 [38mâ”â”â”â•¸â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[39m [37m30/329[39m [38m0:00:00 â€¢ 0:00:04[39m [38m78.38it/s[39m [37mv_num: 0jku val/loss: 0.361 val/acc: 0.840 val/ece: 0.041 val/entropy: 0.263 val/acc_best: 0.845         
                                                                                        [37mval/ece_best: 0.016 val/entropy_best: 0.244 train/loss: 0.264 train/acc: 0.881 train/ece: 0.004          

                                                                                          [37mtrain/entropy: 0.262                                                                                   

                                                                                        [37mval/ece_best: 0.016 val/entropy_best: 0.244 train/loss: 0.263 train/acc: 0.880 train/ece: 0.006          

                                                                                          [37mtrain/entropy: 0.262                                                                                   



                                                                                          [37mtrain/entropy: 0.263                                                                                   




                                                                                         [37mval/ece_best: 0.016 val/entropy_best: 0.244 train/loss: 0.262 train/acc: 0.881 train/ece: 0.003         
                                                                                          [37mtrain/entropy: 0.261                                                                                   


[37mValidation[39m  [38mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•ºâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[39m [37m145/377
/local/scratch/a/ko120/miniconda3/envs/dm_real/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:424: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=23` in the `DataLoader` to improve performance.
Epoch 29/29 [38mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[39m [37m329/329[39m [38m0:00:04 â€¢ 0:00:00[39m [38m75.55it/s[39m [37mv_num: 0jku val/loss: 0.368 val/acc: 0.836 val/ece: 0.051 val/entropy: 0.249 val/acc_best: 0.845        
                                                                                         [37mval/ece_best: 0.016 val/entropy_best: 0.244 train/loss: 0.261 train/acc: 0.881 train/ece: 0.003         
                                                                                         [37mtrain/entropy: 0.261                                                                                    
[?25h[[36m2024-08-28 15:43:10,401[39m][[34msrc.training_pipeline[39m][[32mINFO[39m] - Starting testing!
[[36m2024-08-28 15:43:10,402[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - Restoring states from the checkpoint path at /local/scratch/a/ko120/DM-Benchmark/checkpoints/epoch_008-v1.ckpt
[[36m2024-08-28 15:43:10,406[39m][[34mpytorch_lightning.accelerators.cuda[39m][[32mINFO[39m] - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
[[36m2024-08-28 15:43:10,470[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - Loaded model weights from the checkpoint at /local/scratch/a/ko120/DM-Benchmark/checkpoints/epoch_008-v1.ckpt

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ[1m        Test metric        [22mâ”ƒ[1m       DataLoader 0        [22mâ”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚[36m         test/acc          [39mâ”‚[35m    0.8502984046936035     [39mâ”‚
â”‚[36m    test/calibrated_acc    [39mâ”‚[35m    0.8502984046936035     [39mâ”‚
â”‚[36m    test/calibrated_ece    [39mâ”‚[35m   0.011653589084744453    [39mâ”‚
â”‚[36m  test/calibrated_entropy  [39mâ”‚[35m    0.33279648423194885    [39mâ”‚
â”‚[36m   test/calibrated_kcal    [39mâ”‚[35m  0.00023120595142245293   [39mâ”‚
â”‚[36m         test/ece          [39mâ”‚[35m   0.011653343215584755    [39mâ”‚
â”‚[36m       test/entropy        [39mâ”‚[35m    0.33279648423194885    [39mâ”‚
â”‚[36m         test/kcal         [39mâ”‚[35m  1.1530937626957893e-05   [39mâ”‚
â”‚[36m         test/loss         [39mâ”‚[35m    0.33274489641189575    [39mâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
[37mTesting[39m [38mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[39m [37m754/754[39m [38m0:00:03 â€¢ 0:00:00[39m [38m211.04it/s
[?25h[[36m2024-08-28 15:43:14,855[39m][[34msrc.training_pipeline[39m][[32mINFO[39m] - Finalizing!