[[36m2024-08-26 16:53:17,617[39m][[34msrc.training_pipeline[39m][[32mINFO[39m] - Starting training!
┏━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃[1m    [22m┃[1m Name                    [22m┃[1m Type                                 [22m┃[1m Params [22m┃[1m Mode  [22m┃
┡━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ 0  │ net                     │ MLP                                  │ 93.2 K │ train │
│ 1  │ net.hiddens             │ ModuleList                           │ 93.2 K │ train │
│ 2  │ net.hiddens.0           │ Linear                               │ 26.9 K │ train │
│ 3  │ net.hiddens.1           │ Linear                               │ 65.8 K │ train │
│ 4  │ net.hiddens.2           │ Linear                               │    514 │ train │
│ 5  │ train_acc               │ BinaryAccuracy                       │      0 │ train │
│ 6  │ val_acc                 │ BinaryAccuracy                       │      0 │ train │
│ 7  │ test_acc                │ BinaryAccuracy                       │      0 │ train │
│ 8  │ train_ece               │ MulticlassCalibrationError           │      0 │ train │
│ 9  │ val_ece                 │ MulticlassCalibrationError           │      0 │ train │
│ 10 │ test_ece                │ MulticlassCalibrationError           │      0 │ train │
│ 11 │ train_entropy           │ ShannonEntropyError                  │      0 │ train │
│ 12 │ val_entropy             │ ShannonEntropyError                  │      0 │ train │
│ 13 │ test_entropy            │ ShannonEntropyError                  │      0 │ train │
│ 14 │ test_kcal               │ ClassificationKernelCalibrationError │      0 │ train │
│ 15 │ val_acc_best            │ MaxMetric                            │      0 │ train │
│ 16 │ val_ece_best            │ MinMetric                            │      0 │ train │
│ 17 │ val_entropy_best        │ MinMetric                            │      0 │ train │
│ 18 │ test_calibrated_acc     │ BinaryAccuracy                       │      0 │ train │
│ 19 │ test_calibrated_ece     │ MulticlassCalibrationError           │      0 │ train │
│ 20 │ test_calibrated_entropy │ ShannonEntropyError                  │      0 │ train │
│ 21 │ test_calibrated_kcal    │ ClassificationKernelCalibrationError │      0 │ train │
└────┴─────────────────────────┴──────────────────────────────────────┴────────┴───────┘
[1mTrainable params[22m: 93.2 K
[1mNon-trainable params[22m: 0
[1mTotal params[22m: 93.2 K
[1mTotal estimated model params size (MB)[22m: 0
[1mModules in train mode[22m: 22
[1mModules in eval mode[22m: 0
/local/scratch/a/ko120/miniconda3/envs/dm_real/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:424: The 'val_dataloader' does not have many workers which may
be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=23` in the `DataLoader` to improve performance.
/local/scratch/a/ko120/miniconda3/envs/dm_real/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:424: The 'train_dataloader' does not have many workers which may
be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=23` in the `DataLoader` to improve performance.
[37mEpoch 0/0 [39m [38m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m329/329[39m [38m0:00:02 • 0:00:00[39m [38m144.28it/s[39m [37mv_num: 6mxb
[[36m2024-08-26 16:53:22,128[39m][[34mfsspec.local[39m][[35mDEBUG[39m] - open file: /local/scratch/a/ko120/DM-Benchmark/checkpoints/last.ckpt
[[36m2024-08-26 16:53:22,129[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - `Trainer.fit` stopped: `max_epochs=1` reached.
[37mEpoch 0/0 [39m [38m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m329/329[39m [38m0:00:02 • 0:00:00[39m [38m144.28it/s[39m [37mv_num: 6mxb val/loss: 0.338 val/acc: 0.837 val/ece: 0.018 val/entropy: 0.335 val/acc_best: 0.837          
                                                                                         [37mval/ece_best: 0.018 val/entropy_best: 0.335 train/loss: 0.365                                             
[?25h[[36m2024-08-26 16:53:22,134[39m][[34msrc.training_pipeline[39m][[32mINFO[39m] - Starting testing!
[[36m2024-08-26 16:53:22,135[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - Restoring states from the checkpoint path at /local/scratch/a/ko120/DM-Benchmark/checkpoints/epoch_000.ckpt
[[36m2024-08-26 16:53:22,135[39m][[34mfsspec.local[39m][[35mDEBUG[39m] - open file: /local/scratch/a/ko120/DM-Benchmark/checkpoints/epoch_000.ckpt
[[36m2024-08-26 16:53:22,140[39m][[34mpytorch_lightning.utilities.rank_zero[39m][[32mINFO[39m] - Loaded model weights from the checkpoint at /local/scratch/a/ko120/DM-Benchmark/checkpoints/epoch_000.ckpt
[37mTesting[39m [38m━━━━━━━━━━━━━━━━━━━━━━━╺━━━━━━━━━━━━━━━━[39m [37m438/754[39m [38m0:00:01 • 0:00:02[39m [38m297.03it/s

┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃[1m        Test metric        [22m┃[1m       DataLoader 0        [22m┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│[36m         test/acc          [39m│[35m    0.8431697487831116     [39m│
│[36m    test/calibrated_acc    [39m│[35m    0.8431697487831116     [39m│
│[36m    test/calibrated_ece    [39m│[35m   0.011913063004612923    [39m│
│[36m  test/calibrated_entropy  [39m│[35m    0.3408745527267456     [39m│
│[36m   test/calibrated_kcal    [39m│[35m  0.00020037172362208366   [39m│
│[36m         test/ece          [39m│[35m   0.011913063004612923    [39m│
│[36m       test/entropy        [39m│[35m    0.34087449312210083    [39m│
│[36m         test/kcal         [39m│[35m  1.5597324818372726e-06   [39m│
│[36m         test/loss         [39m│[35m    0.33818456530570984    [39m│
└───────────────────────────┴───────────────────────────┘
[37mTesting[39m [38m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[39m [37m754/754[39m [38m0:00:02 • 0:00:00[39m [38m297.25it/s
[?25h[[36m2024-08-26 16:53:39,155[39m][[34msrc.training_pipeline[39m][[32mINFO[39m] - Finalizing!