2024-08-28 14:55:14,866 INFO    MainThread:1839092 [wandb_setup.py:_flush():76] Current SDK version is 0.17.6
2024-08-28 14:55:14,866 INFO    MainThread:1839092 [wandb_setup.py:_flush():76] Configure stats pid to 1839092
2024-08-28 14:55:14,866 INFO    MainThread:1839092 [wandb_setup.py:_flush():76] Loading settings from /local/scratch/a/ko120/.config/wandb/settings
2024-08-28 14:55:14,866 INFO    MainThread:1839092 [wandb_setup.py:_flush():76] Loading settings from /local/scratch/a/ko120/DM-Benchmark/wandb/settings
2024-08-28 14:55:14,866 INFO    MainThread:1839092 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-08-28 14:55:14,866 INFO    MainThread:1839092 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-08-28 14:55:14,866 INFO    MainThread:1839092 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'train.py', 'program_abspath': '/local/scratch/a/ko120/DM-Benchmark/train.py', 'program': '/local/scratch/a/ko120/DM-Benchmark/train.py'}
2024-08-28 14:55:14,866 INFO    MainThread:1839092 [wandb_setup.py:_flush():76] Applying login settings: {}
2024-08-28 14:55:14,866 INFO    MainThread:1839092 [wandb_init.py:_log_setup():521] Logging user logs to ./wandb/run-20240828_145514-1jmzxber/logs/debug.log
2024-08-28 14:55:14,866 INFO    MainThread:1839092 [wandb_init.py:_log_setup():522] Logging internal logs to ./wandb/run-20240828_145514-1jmzxber/logs/debug-internal.log
2024-08-28 14:55:14,866 INFO    MainThread:1839092 [wandb_init.py:init():559] calling init triggers
2024-08-28 14:55:14,867 INFO    MainThread:1839092 [wandb_init.py:init():566] wandb.init called with sweep_config: {}
config: {}
2024-08-28 14:55:14,867 INFO    MainThread:1839092 [wandb_init.py:init():609] starting backend
2024-08-28 14:55:14,867 INFO    MainThread:1839092 [wandb_init.py:init():613] setting up manager
2024-08-28 14:55:14,869 INFO    MainThread:1839092 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-08-28 14:55:14,870 INFO    MainThread:1839092 [wandb_init.py:init():621] backend started and connected
2024-08-28 14:55:14,874 INFO    MainThread:1839092 [wandb_init.py:init():716] updated telemetry
2024-08-28 14:55:14,880 INFO    MainThread:1839092 [wandb_init.py:init():749] communicating run to backend with 90.0 second timeout
2024-08-28 14:55:15,217 INFO    MainThread:1839092 [wandb_run.py:_on_init():2438] communicating current version
2024-08-28 14:55:15,287 INFO    MainThread:1839092 [wandb_run.py:_on_init():2447] got version response upgrade_message: "wandb version 0.17.7 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-08-28 14:55:15,287 INFO    MainThread:1839092 [wandb_init.py:init():800] starting run threads in backend
2024-08-28 14:55:16,968 INFO    MainThread:1839092 [wandb_run.py:_console_start():2416] atexit reg
2024-08-28 14:55:16,968 INFO    MainThread:1839092 [wandb_run.py:_redirect():2258] redirect: wrap_raw
2024-08-28 14:55:16,969 INFO    MainThread:1839092 [wandb_run.py:_redirect():2323] Wrapping output streams.
2024-08-28 14:55:16,969 INFO    MainThread:1839092 [wandb_run.py:_redirect():2348] Redirects installed.
2024-08-28 14:55:16,972 INFO    MainThread:1839092 [wandb_init.py:init():843] run started, returning control to user process
2024-08-28 14:55:16,973 INFO    MainThread:1839092 [wandb_run.py:_config_callback():1385] config_cb None None {'model': "{'_target_': 'src.models.lightening_module.ClassificationLitModule', 'lr': 0.001, 'weight_decay': 0.0005, 'net': {'_target_': 'src.models.components.models.MLP', 'input_size': 104, 'hwdith': 256, 'hdepth': 2, 'output_size': 2}, 'criterion': {'_target_': 'src.metrics.train_metrics.ClassificationMixedLoss', 'loss_scalers': {'nll': 1, 'mmd': 0.2}, 'operands': {'x': 'rbf', 'y': 'rbf'}, 'scalers': {'x': 1.0, 'y': 1.0}, 'bandwidths': {'x': 10.0, 'y': 0.01}}, 'calibrator': {'_target_': 'src.calibration.calibration.TemperatureScaling'}, 'kcal_kwargs': {'operands': {'x': 'rbf', 'y': 'rbf'}, 'scalers': {'x': 1.0, 'y': 1.0}, 'bandwidths': {'x': 10.0, 'y': 0.01}}}", 'model/params/total': 93186, 'model/params/trainable': 93186, 'model/params/non_trainable': 0, 'datamodule': "{'_target_': 'src.datamodules.classification_datamodule.ClassificationDataModule', 'dataset_name': 'adult', 'data_dir': '${paths.data_dir}', 'batch_size': 64, 'test_batch_size': 8, 'train_val_test_split': [0.7, 0.1, 0.2], 'num_workers': 0, 'pin_memory': False}", 'trainer': "{'_target_': 'pytorch_lightning.Trainer', 'accelerator': 'gpu', 'devices': 1, 'min_epochs': 10, 'max_epochs': 1, 'gradient_clip_val': 0.5}", 'seed': 12345, 'callbacks': "{'model_checkpoint': {'_target_': 'pytorch_lightning.callbacks.ModelCheckpoint', 'monitor': 'val/loss', 'mode': 'min', 'save_top_k': 1, 'save_last': True, 'verbose': False, 'dirpath': 'checkpoints/', 'filename': 'epoch_{epoch:03d}', 'auto_insert_metric_name': False}, 'early_stopping': {'_target_': 'pytorch_lightning.callbacks.EarlyStopping', 'monitor': 'val/loss', 'mode': 'min', 'patience': 30, 'min_delta': 0}, 'model_summary': {'_target_': 'pytorch_lightning.callbacks.RichModelSummary', 'max_depth': -1}, 'rich_progress_bar': {'_target_': 'pytorch_lightning.callbacks.RichProgressBar'}}"}
2024-08-28 15:04:51,181 WARNING MsgRouterThr:1839092 [router.py:message_loop():77] message_loop has been closed
